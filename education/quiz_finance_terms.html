<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>[SKILL_NAME] 101: [SKILL_SUBTITLE]ï¼ˆå­¦ç¿’ãƒ‰ãƒªãƒ«ï¼‰</title>
  <link rel="alternate" hreflang="ja" href="quiz_finance_terms.html" />
  <link rel="alternate" hreflang="en" href="quiz_finance_terms_en.html" />
  <link rel="stylesheet" href="quiz.css" />
  <style>
    :root{
      --bg-gradient-top:#0b0f14;
      --bg-gradient-bottom:#0d141c;
      --fg:#e7eef6;
      --muted:#8aa0b5;
      --accent:#4ea1ff;
      --accent-2:#9be37f;
      --card:#0f1722;
      --glass:rgba(255,255,255,0.03);
      --glass-2:rgba(255,255,255,0.02);
      --border:#1c2531;
      --ok:#36d399;
      --warn:#ffcc66;
      --danger:#ff6b6b;
      --shadow:0 12px 30px rgba(2,6,23,.6);
      --choice-hover:linear-gradient(90deg, rgba(78,161,255,0.04), rgba(155,227,127,0.02));
      --control-padding-y:.5rem;
      --control-padding-x:1rem;
      --control-font-size:.9rem;
      --control-min-height:44px;
      --control-icon-size:1.05rem;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
  body{margin:0;background:linear-gradient(180deg,var(--bg-gradient-top),var(--bg-gradient-top) 40%,var(--bg-gradient-bottom) 100%);color:var(--fg);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";transition:background .3s ease,color .3s ease}
    a{color:var(--accent)}
    .container{max-width:980px;margin:0 auto;padding:28px 16px 48px}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:12px;flex-wrap:wrap}
    h1{font-size:clamp(20px,3.6vw,34px);margin:0 0 6px}
    h2{font-size:clamp(16px,2.6vw,22px);margin:0;color:var(--muted)}
  .badge{display:inline-flex;align-items:center;gap:.35rem;padding:.25rem .75rem;border:1px solid var(--border);border-radius:999px;background:rgba(255,255,255,.03);color:var(--muted);font-size:.85rem;line-height:1;min-height:var(--control-min-height)}
    .badge.clickable{cursor:pointer;user-select:none}
    .badge.clickable:focus{outline:2px solid var(--accent);outline-offset:2px}
  .card{background:linear-gradient(180deg,var(--glass),var(--glass-2));border:1px solid rgba(255,255,255,0.03);border-radius:16px;box-shadow:var(--shadow);backdrop-filter:blur(6px)}
    .panel{display:grid;gap:12px;padding:16px;margin:16px 0}
    .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
    .btn{appearance:none;border:1px solid var(--border);background:#141c27;color:var(--fg);padding:.55rem .8rem;border-radius:10px;cursor:pointer}
    .btn:hover{border-color:#2a3748}
  .lang-toggle{display:inline-flex;border-radius:999px;overflow:hidden;border:1px solid rgba(255,255,255,0.08);background:rgba(15,23,34,0.6);padding:4px;flex:0 0 auto;min-width:260px;flex-shrink:0}
  .lang-toggle a, .lang-toggle button{padding:var(--control-padding-y) var(--control-padding-x);background:transparent;border:0;color:var(--muted);cursor:pointer;text-decoration:none;display:inline-flex;align-items:center;justify-content:center;font-weight:600;font-size:var(--control-font-size);white-space:nowrap;min-width:120px;text-align:center;flex:1 1 0;line-height:1}
  .lang-toggle a.active, .lang-toggle button.active{background:linear-gradient(90deg,var(--accent),#59b0ff);color:white}
  .theme-toggle{appearance:none;border:1px solid rgba(255,255,255,0.18);background:rgba(15,23,34,0.65);color:var(--muted);padding:var(--control-padding-y) var(--control-padding-x);border-radius:999px;font-size:var(--control-font-size);font-weight:600;cursor:pointer;transition:all .15s ease;display:inline-flex;align-items:center;justify-content:center;gap:.5rem;min-height:var(--control-min-height);line-height:1}
  .theme-toggle:hover{color:var(--fg);border-color:rgba(255,255,255,0.35)}
  .theme-toggle .theme-icon{font-size:var(--control-icon-size);line-height:1}
  .theme-toggle .theme-label{line-height:1;font-size:var(--control-font-size)}
  .header-controls{display:flex;gap:12px;align-items:center;flex-wrap:wrap;justify-content:flex-start}
  .brand{display:flex;align-items:flex-start;margin-bottom:6px}
  .brand a{display:inline-flex;align-items:center;gap:.65rem;text-decoration:none;color:var(--fg);font-weight:600;font-size:clamp(16px,2.1vw,20px);letter-spacing:.03em}
  .brand img{height:40px;width:auto;max-width:140px}
  .brand .name{white-space:nowrap}
  .answer-btn{appearance:none;border:1px dashed rgba(255,255,255,0.16);background:rgba(15,23,34,0.6);color:var(--muted);padding:.35rem .8rem;border-radius:8px;cursor:pointer;transition:all .15s ease;font-size:.85rem}
  .answer-btn:hover{color:var(--fg);border-color:rgba(255,255,255,0.35)}
    .btn.ghost{background:transparent}
    .btn.primary{background:linear-gradient(180deg,#1b2a3a,#132030);border-color:#223045}
    .btn.success{background:#153521;border-color:#1d5b3f}
    .btn.warn{background:#2a2412;border-color:#5f4c1a;color:#ffdf99}
    .switch{display:inline-flex;gap:.6rem;align-items:center}
    input[type="checkbox" i]{cursor:pointer}
    input[type="checkbox"], input[type="radio"]{accent-color:var(--accent)}
    /* Modern toggle for settings */
    .switch input{position:absolute;opacity:0;width:0;height:0}
    .switch .ui-toggle{width:52px;height:28px;border-radius:999px;border:1px solid var(--border);background:#101826;position:relative;display:inline-block;transition:all .18s ease;box-shadow:inset 0 2px 6px rgba(0,0,0,.35)}
    .switch .ui-toggle::after{content:"";position:absolute;top:50%;left:4px;transform:translateY(-50%);width:22px;height:22px;border-radius:50%;background:linear-gradient(180deg,#f9fafb,#dbe3ee);box-shadow:0 2px 4px rgba(0,0,0,.35);transition:left .18s ease}
    .switch input:checked + .ui-toggle{background:linear-gradient(90deg,var(--accent),#59b0ff);border-color:#2a7dd6}
    .switch input:checked + .ui-toggle::after{left:calc(100% - 26px)}
    .switch .switch-label{color:var(--muted)}
    .switch:focus-within .ui-toggle{outline:2px solid rgba(78,161,255,.6);outline-offset:2px}
  /* Live score */
  #score-badge{display:inline-flex;align-items:center;justify-content:center;gap:.25rem;padding:.25rem .75rem;border:1px solid var(--border);border-radius:999px;background:rgba(255,255,255,.03);color:var(--muted);font-size:.85rem;line-height:1;min-height:var(--control-min-height);white-space:nowrap}
    .scope, .tip{padding:16px}
    .scope ul{margin:.35rem 0 .1rem 1.1rem}
    .muted{color:var(--muted)}
    details.cheatsheet{margin:16px 0}
    details.cheatsheet summary{cursor:pointer;padding:12px 16px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));border:1px solid var(--border);color:var(--fg)}
    .sheet{padding:16px 16px 4px}

    /* Questions */
    .q{padding:16px;margin:18px 0}
    .q header{display:flex;justify-content:space-between;align-items:center;margin:0 0 12px}
    .q h4{margin:0;font-size:18px}
    .q .type{font-size:.8rem;color:var(--muted)}
    .q .body{display:grid;gap:12px}
    .choices{display:grid;gap:8px;margin-left:.2rem;padding:12px;border:1px solid var(--border);border-radius:16px;background:linear-gradient(180deg,var(--glass),var(--glass-2))}
    .choice{display:flex;gap:10px;align-items:center;padding:12px 12px 12px 46px;border:1px dashed transparent;border-radius:16px;position:relative;min-height:46px}
  .choice{transition:all .18s ease;position:relative;padding:12px 12px 12px 46px;min-height:46px;border-radius:16px;border:1px dashed transparent}
  .choice:hover{background:var(--choice-hover);transform:translateY(-3px);box-shadow:0 6px 18px rgba(2,6,23,.45)}
  /* Hide native control but keep accessible */
  .choice input{position:absolute!important;width:1px;height:1px;margin:-1px;padding:0;border:0;clip:rect(1px,1px,1px,1px);overflow:hidden}
  /* Custom indicator */
  .choice{--ind-size:18px;--ind-radius:50%}
  .choice:has(input[type=checkbox]){--ind-radius:6px}
  .choice::before{content:"";position:absolute;left:14px;top:50%;transform:translateY(-50%);width:var(--ind-size);height:var(--ind-size);border-radius:var(--ind-radius);border:2px solid var(--border);background:rgba(255,255,255,0.04)}
  .choice::after{content:"";position:absolute;left:14px;top:50%;transform:translate(3px,-50%) scale(.2);transform-origin:center;border-radius:50%;width:calc(var(--ind-size) - 6px);height:calc(var(--ind-size) - 6px);background:linear-gradient(180deg,#5aaaff,#2d7df0);opacity:0;transition:transform .18s ease,opacity .18s ease}
  .choice:has(input[type=checkbox])::after{content:"âœ“";width:auto;height:auto;background:transparent;color:white;font-weight:800;font-size:12px;left:calc(14px + 9px);transform:translate(-50%,-50%) scale(.2);text-shadow:0 1px 1px rgba(0,0,0,.35)}
  .choice:has(input[type=checkbox]:checked)::before{background:linear-gradient(180deg,#3a8bff,#2d7df0);border-color:#2a7dd6}
  .choice:has(input[type=radio]:checked)::before{background:linear-gradient(180deg,#3a8bff,#2d7df0);border-color:#2a7dd6}
  .choice:has(input[type=radio]:checked)::after{opacity:1;transform:translate(3px,-50%) scale(1)}
  .choice:has(input[type=checkbox]:checked)::after{opacity:1;transform:translate(-50%,-50%) scale(1)}
  .choice:has(input:checked){background:linear-gradient(90deg, rgba(78,161,255,0.12), rgba(155,227,127,0.06));border:1px solid rgba(78,161,255,0.35);box-shadow:0 6px 18px rgba(2,6,23,.35)}
  .choice:has(input:not(:checked)):hover{border:1px dashed rgba(255,255,255,0.12)}
  .choice:has(input:focus-visible){outline:2px solid rgba(78,161,255,.7);outline-offset:2px}
    .choice.correct{border-color:#1f3f2c;background:rgba(54,211,153,.07)}
    .choice.wrong{border-color:#4a2525;background:rgba(255,107,107,.06)}
    .explain{display:none;padding:12px;border-left:3px solid #2a6bb8;background:#0f1722;border-radius:8px}
    .explain.show{display:block}
  .q{transition:transform .12s ease, box-shadow .12s ease}
  .q:hover{transform:translateY(-4px);box-shadow:0 10px 30px rgba(2,6,23,.45)}
    .q footer{display:flex;gap:8px;align-items:center}

    /* Active tasks: classify (drag & drop) */
    .dd-wrap{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .bucket{border:1px dashed var(--border);border-radius:14px;padding:10px;min-height:72px;background:rgba(255,255,255,0.02)}
    .bucket h5{margin:0 0 6px;font-size:.9rem;color:var(--muted)}
    .chip{display:inline-flex;align-items:center;gap:.35rem;padding:.35rem .6rem;border:1px solid var(--border);border-radius:999px;background:rgba(255,255,255,0.04);cursor:grab;user-select:none;margin:4px}
    .chip:active{cursor:grabbing}
    .bucket.hover{border-color:rgba(78,161,255,0.55);background:rgba(78,161,255,0.06)}

    /* Active tasks: segmented chart selector */
    .mini-chart{position:relative;border:1px solid var(--border);border-radius:14px;padding:10px;background:linear-gradient(180deg,var(--glass),var(--glass-2))}
    .segments{position:absolute;left:10px;right:10px;bottom:10px;display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
    .segment{appearance:none;border:1px solid var(--border);background:rgba(255,255,255,0.06);color:var(--muted);border-radius:10px;padding:.25rem .4rem;cursor:pointer}
    .segment.selected{background:linear-gradient(90deg,var(--accent),#59b0ff);color:#fff;border-color:#2a7dd6}

    /* Results */
    .results{padding:16px;margin-top:10px}
    table{width:100%;border-collapse:collapse}
    th,td{border-top:1px solid var(--border);padding:8px 10px;text-align:left}
    tr:hover td{background:rgba(255,255,255,.02)}

    /* Accessibility */
    .sr-only{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}

    @media print{
      .panel button,.panel input,.panel .badge{display:none!important}
      body{background:white;color:black}
      .card{box-shadow:none;border-color:#ccc}
    }

    body[data-theme="light"]{
      --bg-gradient-top:#f5f7fb;
      --bg-gradient-bottom:#e6ebf5;
      --fg:#1f2937;
      --muted:#5a6b83;
      --accent:#2563eb;
      --accent-2:#16a34a;
      --card:#ffffff;
      --glass:rgba(255,255,255,0.92);
      --glass-2:rgba(255,255,255,0.86);
      --border:rgba(15,23,42,0.12);
      --shadow:0 12px 30px rgba(15,23,42,0.12);
      --choice-hover:linear-gradient(90deg, rgba(37,99,235,0.08), rgba(22,163,74,0.05));
    }
    body[data-theme="light"] .card{background:linear-gradient(180deg,rgba(255,255,255,0.95),rgba(255,255,255,0.9));border:1px solid rgba(15,23,42,0.1);box-shadow:var(--shadow);color:var(--fg)}
    body[data-theme="light"] .lang-toggle{border:1px solid rgba(15,23,42,0.12);background:rgba(255,255,255,0.8)}
    body[data-theme="light"] .lang-toggle a{color:#4b5563}
    body[data-theme="light"] .theme-toggle{border-color:rgba(15,23,42,0.15);background:rgba(255,255,255,0.85);color:#4b5563}
    body[data-theme="light"] .theme-toggle:hover{color:#1f2937;border-color:rgba(37,99,235,0.45)}
    body[data-theme="light"] .answer-btn{background:rgba(255,255,255,0.9);color:#4b5563;border-color:rgba(15,23,42,0.16)}
    body[data-theme="light"] .answer-btn:hover{color:#1f2937;border-color:rgba(37,99,235,0.35)}
    body[data-theme="light"] .btn{border-color:rgba(15,23,42,0.12)}
    body[data-theme="light"] .btn.ghost{background:rgba(255,255,255,0.7);color:#1f2937}
    body[data-theme="light"] .btn.primary{background:linear-gradient(180deg,#3b82f6,#2563eb);border-color:#1d4ed8;color:#f8fafc}
    body[data-theme="light"] .btn.success{background:#22c55e;border-color:#16a34a;color:#f0fdf4}
    body[data-theme="light"] .btn.warn{background:#fde68a;border-color:#f59e0b;color:#92400e}
    body[data-theme="light"] .choices{border-color:rgba(15,23,42,0.12);background:rgba(255,255,255,0.95)}
    body[data-theme="light"] .choice:hover{box-shadow:0 6px 18px rgba(15,23,42,0.12)}
    body[data-theme="light"] .choice::before{background:rgba(0,0,0,0.02);border-color:rgba(15,23,42,0.25)}
    body[data-theme="light"] .choice.correct{border-color:rgba(34,197,94,0.45);background:rgba(34,197,94,0.15)}
    body[data-theme="light"] .choice.wrong{border-color:rgba(248,113,113,0.4);background:rgba(248,113,113,0.18)}
    body[data-theme="light"] .explain{background:rgba(226,232,240,0.9);border-left:3px solid #2563eb;color:#1f2937}
    body[data-theme="light"] .muted{color:#5a6b83}
    body[data-theme="light"] .badge{border-color:rgba(15,23,42,0.15);background:rgba(255,255,255,0.75);color:#475569}
    body[data-theme="light"] details.cheatsheet summary{background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(255,255,255,0.92));color:#1f2937}
    body[data-theme="light"] .brand a{color:#1f2937}
  </style>
</head>
<body data-theme="dark">
  <!-- ====== SETTINGS (ç·¨é›†å¯) =============================================== -->
  <script>
    window.DRILL_SETTINGS = {
  SKILL_NAME: "ECB/BIS é‡‘èç”¨èª",
  SKILL_SUBTITLE: "åˆå¿ƒè€…ã®ãŸã‚ã®åŸºæœ¬ç”¨èªãƒã‚¹ã‚¿ãƒ¼",
  GOAL_DESCRIPTION: "ä¸»è¦ãªç”¨èªã‚’å®šç¾©ã—ã€è‡ªåˆ†ã®è¨€è‘‰ã§èª¬æ˜ã§ãã‚‹",
  LEARNING_MODE_DEFAULT: true,
  BRAND_NAME: "Toppy Microservices",
  BRAND_LOGO: "/toppy_bimi.svg",
  BRAND_URL: "/"
};
  </script>
  <!-- ====================================================================== -->

  <div class="container">
    <header>
      <div>
        <div class="brand">
          <a id="brand-link" href="/" aria-label="Toppy Microservices">
            <img id="brand-logo" alt="Toppy Microservices ãƒ­ã‚´" src="/toppy_bimi.svg">
            <span id="brand-name" class="name">Toppy Microservices</span>
          </a>
        </div>
        <h1 id="title" data-i18n="title">[SKILL_NAME] 101: [SKILL_SUBTITLE]ï¼ˆå­¦ç¿’ãƒ‰ãƒªãƒ«ï¼‰</h1>
        <h3 id="subtitle" data-i18n="subtitle">[SKILL_NAME] ã‚’ã€Œ[GOAL_DESCRIPTION]ã€ã¾ã§å¼•ãä¸Šã’ã‚‹ãŸã‚ã®ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ»ãƒ‰ãƒªãƒ«</h3>
      </div>
      <div class="header-controls">
        <button type="button" class="theme-toggle" id="themeToggle" aria-pressed="false" aria-label="ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ" data-next="light">
          <span class="theme-icon" aria-hidden="true">â˜€ï¸</span>
          <span class="theme-label">ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰</span>
        </button>
        <div class="lang-toggle" role="tablist" aria-label="Language switcher">
          <a id="lang-ja" class="active" aria-current="page" href="quiz_finance_terms.html">æ—¥æœ¬èª</a>
          <a id="lang-en" href="quiz_finance_terms_en.html">English</a>
        </div>
        <button type="button" class="badge clickable" id="mode-badge" aria-live="polite" aria-pressed="true" title="ã‚¯ãƒªãƒƒã‚¯ã§å­¦ç¿’/ãƒ†ã‚¹ãƒˆåˆ‡æ›¿">å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰</button>
        <span id="score-badge" aria-live="polite" title="ãƒ©ã‚¤ãƒ–ã‚¹ã‚³ã‚¢">0 / 0</span>
      </div>
    </header>

    <section class="card scope" aria-labelledby="scope-h">
      <h3 id="scope-h" data-i18n="scope_h">ãƒ†ã‚¹ãƒˆã®ç¯„å›²</h3>
      <ul>
  <li><strong>æƒ³å®šãƒ¬ãƒ™ãƒ«</strong>: é‡‘èã¯åˆå¿ƒè€…ã ãŒã€ç”¨èªã‚’è¦šãˆã¦è³‡æ–™ã‚’èª­ã¿è§£ã‘ã‚‹ã‚ˆã†ã«ãªã‚ŠãŸã„ã€‚</li>
  <li><strong>å¯¾è±¡ãƒˆãƒ”ãƒƒã‚¯</strong>:
    <ul>
      <li>ECB / BIS / WDI / FRED ã®åŸºç¤</li>
      <li>BSIï¼ˆéŠ€è¡Œçµ±è¨ˆï¼‰ã®ã€ŒOutstandingï¼ˆæ®‹é«˜ï¼‰ã€ã¨éƒ¨é–€åŒºåˆ†</li>
      <li>M3ãƒ»ãƒ­ãƒ¼ãƒ³æ®‹é«˜ãƒ»æ”¿ç­–é‡‘åˆ©ãƒ»ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ãƒ»æµå‹•æ€§</li>
    </ul>
  </li>
  <li><strong>å¯¾è±¡å¤–</strong>: ä¸Šç´šãƒ‡ãƒªãƒãƒ†ã‚£ãƒ–ã€ä¼šè¨ˆä»•è¨³ã®è©³ç´°ã€ãƒãƒ¼ã‚¼ãƒ«è¦åˆ¶ã®æ•°å¼å°å‡ºã€‚</li>
</ul>
    </section>

    <section class="card panel" aria-labelledby="ops-h">
      <h3 id="ops-h" data-i18n="ops_h">æ“ä½œãƒ‘ãƒãƒ«</h3>
      <div class="row">
  <label class="switch" for="learningMode">
    <input id="learningMode" type="checkbox" checked>
    <span class="ui-toggle" aria-hidden="true"></span>
    <span class="switch-label" data-i18n="learning_mode">å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ï¼ˆé¸æŠ/å…¥åŠ›ã—ãŸè¨­å•ã®è§£èª¬ã‚’å³è¡¨ç¤ºï¼‰</span>
  </label>
      </div>
      <div class="row">
  <button class="btn ghost" id="showAll" data-i18n="show_all">è§£èª¬ å…¨è¡¨ç¤º</button>
  <button class="btn ghost" id="hideAll" data-i18n="hide_all">è§£èª¬ å…¨éè¡¨ç¤º</button>
  <button class="btn primary" id="regen" data-i18n="regen">çµæœãƒ†ãƒ¼ãƒ–ãƒ«å†ç”Ÿæˆ</button>
  <button class="btn success" id="showAnswersScore">è§£ç­”ã¨ã‚¹ã‚³ã‚¢ã‚’è¡¨ç¤º</button>
      </div>
  <p class="tip muted" data-i18n="learning_tip"><strong>å­¦ç¿’TIP:</strong> â€œåˆ†ã‹ã£ãŸâ€ ã‚’ â€œè‡ªåˆ†ã®è¨€è‘‰ã§èª¬æ˜ã§ãã‚‹â€ çŠ¶æ…‹ã«å¼•ãä¸Šã’ã‚‹ã“ã¨ã‚’ç›®æ¨™ã«ã™ã‚‹ã¹ã—ã€‚</p>
    <p class="muted" id="usage-note">ä½¿ã„æ–¹: 1) å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã§ã¯å›ç­”ã™ã‚‹ã¨å³åº§ã«è§£èª¬ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚2) ã€Œè§£ç­”ã¨ã‚¹ã‚³ã‚¢ã‚’è¡¨ç¤ºã€ã§æ­£è§£ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ã€ç¾åœ¨ã®ã‚¹ã‚³ã‚¢ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚3) ã€Œçµæœãƒ†ãƒ¼ãƒ–ãƒ«å†ç”Ÿæˆã€ã§å›ç­”ä¸€è¦§ã‚’æ›´æ–°ã—ã¾ã™ã€‚</p>
      <div class="results card" id="results" aria-live="polite" style="display:none"></div>
    </section>

    <details class="cheatsheet card">
      <summary data-i18n="cheat_summary">Cheat Sheet: æœ€å°ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆä»»æ„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼‰</summary>
      <div class="sheet">
  <ul>
    <li><strong>Outstanding</strong>: æœŸæœ«æ®‹é«˜ï¼ã‚¹ãƒˆãƒƒã‚¯ï¼ˆçŠ¶æ…‹é‡ï¼‰ã€‚</li>
    <li><strong>M3</strong>: â€œåºƒã„ãŠé‡‘â€ã€‚ç¾é‡‘ï¼‹å„ç¨®é é‡‘ï¼‹è¿‘ä¼¼è³‡ç”£ã€‚</li>
    <li><strong>Depth</strong>: åšã¿ï¼è¦æ¨¡ã€‚ãƒ­ãƒ¼ãƒ³æ®‹é«˜ / å‚µåˆ¸ Outstandingã€‚</li>
    <li><strong>Turnover</strong>: å£²è²·ã®æ´»ç™ºã•ï¼ˆæ ªå¼å¸‚å ´ã§é »ç”¨ï¼‰ã€‚</li>
    <li><strong>DFR / MRO</strong>: ECB ã®ä¸»è¦æ”¿ç­–é‡‘åˆ©ã€‚</li>
    <li><strong>Liquidity</strong>: ã™ãç¾é‡‘ã«å¤‰ãˆã‚‰ã‚Œã‚‹åº¦åˆã„ã€‚</li>
  </ul>
</div>
    </details>

    <!-- ================== QUESTIONS ======================================= -->
    <section id="questions">
<!-- =============== FINANCE TERMS QUIZ =============== -->

<!-- Q1 -->
<article class="q card" data-id="Q1" data-type="mc" data-answer="b">
  <header>
    <h4 data-i18n="Q1_h">Q1: â€œOutstandingâ€ ã®æœ€ã‚‚è¿‘ã„æ„å‘³ã¯ï¼Ÿ</h4>
    <span class="type" data-i18n="Q1_type">Type: Multiple Choice</span>
  </header>
  <div class="body">
    <p>ECB BSI ã®ã€ŒOutstanding amountsã€ã«ãŠã‘ã‚‹ â€œOutstandingâ€ ã¯ä½•ã‚’æŒ‡ã™ï¼Ÿ</p>
    <fieldset class="choices">
  <label class="choice"><input type="radio" name="Q1" value="a"> <span data-i18n="Q1_a">A. å½“æœˆã®æ–°è¦å–å¼•ã®åˆè¨ˆï¼ˆãƒ•ãƒ­ãƒ¼ï¼‰</span></label>
  <label class="choice"><input type="radio" name="Q1" value="b"> <span data-i18n="Q1_b">B. ã‚ã‚‹æ™‚ç‚¹ã§æœªæ¶ˆåŒ–ã§æ®‹ã£ã¦ã„ã‚‹é‡‘é¡ï¼ˆã‚¹ãƒˆãƒƒã‚¯ï¼‰</span></label>
  <label class="choice"><input type="radio" name="Q1" value="c"> <span data-i18n="Q1_c">C. æ”¿ç­–é‡‘åˆ©ã®èª˜å°ç›®æ¨™å€¤</span></label>
    </fieldset>
    <div class="explain" id="exp-Q1">
      <strong>è§£èª¬:</strong> Outstanding ã¯ â€œæœŸæœ«æ®‹é«˜â€ ï¼ ã‚¹ãƒˆãƒƒã‚¯ã€‚å–å¼•ãƒ•ãƒ­ãƒ¼ã¨ã¯åŒºåˆ¥ã•ã‚Œã‚‹ã€‚
      ç‰©ç†ã®ã‚¢ãƒŠãƒ­ã‚¸ãƒ¼ã§ã¯ã€ŒçŠ¶æ…‹é‡ã€ã«è¿‘ã„ã€‚
    </div>
  </div>
</article>

<!-- Q17 (Classify: Drag & Drop) -->
<article class="q card" data-id="Q17" data-type="classify" data-answer="stock:a,c,e;flow:b,d,f">
  <header>
    <h4>Q17: æ¬¡ã®ç”¨èªã‚’ â€œã‚¹ãƒˆãƒƒã‚¯(Stock)â€ ã¨ â€œãƒ•ãƒ­ãƒ¼(Flow)â€ ã«åˆ†é¡ã›ã‚ˆï¼ˆãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ï¼‰</h4>
    <span class="type">Type: Classify (DnD)</span>
  </header>
  <div class="body">
    <div class="dd-wrap">
      <div class="bucket" data-group="stock" aria-label="Stock bucket">
        <h5>ã‚¹ãƒˆãƒƒã‚¯</h5>
        <!-- ãƒ‰ãƒ­ãƒƒãƒ—ã§å…¥ã‚Œã‚‹ -->
      </div>
      <div class="bucket" data-group="flow" aria-label="Flow bucket">
        <h5>ãƒ•ãƒ­ãƒ¼</h5>
      </div>
    </div>
    <div class="bucket pool" data-group="pool" aria-label="ç”¨èªã®ãƒ—ãƒ¼ãƒ«">
      <span class="chip" draggable="true" data-value="a">Outstanding æ®‹é«˜</span>
      <span class="chip" draggable="true" data-value="b">æœˆé–“æ–°è¦å–å¼•ï¼ˆTransactionsï¼‰</span>
      <span class="chip" draggable="true" data-value="c">è²¸å‡ºæ®‹é«˜ï¼ˆLoans outstandingï¼‰</span>
      <span class="chip" draggable="true" data-value="d">ä»Šæœˆã®æ–°è¦è²¸å‡ºé¡</span>
      <span class="chip" draggable="true" data-value="e">M3 æ®‹é«˜</span>
      <span class="chip" draggable="true" data-value="f">ç´”ç™ºè¡Œé¡ï¼ˆå½“æœˆï¼‰</span>
    </div>
    <div class="explain" id="exp-Q17">
      <strong>è§£èª¬:</strong> ã‚¹ãƒˆãƒƒã‚¯ã¯ã‚ã‚‹æ™‚ç‚¹ã®ã€Œæ®‹é«˜ã€ã€‚ãƒ•ãƒ­ãƒ¼ã¯ã‚ã‚‹æœŸé–“ã®ã€Œå¢—æ¸›ã€ã€‚ä¾‹ãˆã° M3 æ®‹é«˜ã‚„è²¸å‡ºæ®‹é«˜ã¯ã‚¹ãƒˆãƒƒã‚¯ã€å½“æœˆã®æ–°è¦å–å¼•ã‚„ç´”ç™ºè¡Œã¯ãƒ•ãƒ­ãƒ¼ã€‚
    </div>
  </div>
</article>

<!-- Q18 (Chart segment select) -->
<article class="q card" data-id="Q18" data-type="segment" data-answer="2">
  <header>
    <h4>Q18: æ¬¡ã®ç°¡æ˜“ãƒãƒ£ãƒ¼ãƒˆã§ â€œé‡‘èå¼•ãç· ã‚ãŒå¼·ã‹ã£ãŸæœŸé–“â€ ã‚’é¸ã¹</h4>
    <span class="type">Type: Chart segment</span>
  </header>
  <div class="body">
    <div class="mini-chart" style="height:180px">
      <canvas id="miniChart" width="560" height="110" style="width:100%;height:110px"></canvas>
      <div class="segments" role="group" aria-label="æœŸé–“é¸æŠ">
        <button type="button" class="segment" data-idx="1">æœŸé–“A</button>
        <button type="button" class="segment" data-idx="2">æœŸé–“B</button>
        <button type="button" class="segment" data-idx="3">æœŸé–“C</button>
      </div>
    </div>
    <p class="muted" style="margin:.4rem 0 0">é’ï¼æ”¿ç­–é‡‘åˆ©ã€ç·‘ï¼ãƒ­ãƒ¼ãƒ³æ®‹é«˜ã®ä¼¸ã³ï¼ˆæ¨¡å¼å›³ï¼‰</p>
    <div class="explain" id="exp-Q18">
      <strong>è§£èª¬:</strong> å¼•ãç· ã‚ã¯é€šå¸¸ã€æ”¿ç­–é‡‘åˆ©ã®ä¸Šæ˜‡ã¨ä¿¡ç”¨ã®ä¼¸ã³ã®éˆåŒ–ãŒåŒæ™‚ã«è¦³å¯Ÿã§ãã‚‹æœŸé–“ã€‚æœŸé–“Bã¯é’ç·šãŒä¸Šæ˜‡ã—ã€ç·‘ç·šãŒä½ä¸‹å‚¾å‘ã«ã‚ã‚‹ãŸã‚æœ€ã‚‚å¼•ãç· ã‚çš„ã€‚
    </div>
  </div>
</article>

<!-- Q2 -->
<article class="q card" data-id="Q2" data-type="mc" data-answer="a">
  <header>
    <h4 data-i18n="Q2_h">Q2: ECBï¼ˆEuropean Central Bankï¼‰ã®å½¹å‰²ã¯ï¼Ÿ</h4>
    <span class="type" data-i18n="Q2_type">Type: Multiple Choice</span>
  </header>
  <div class="body">
    <fieldset class="choices">
  <label class="choice"><input type="radio" name="Q2" value="a"> <span data-i18n="Q2_a">A. ãƒ¦ãƒ¼ãƒ­åœã®é‡‘èæ”¿ç­–ï¼ˆæ”¿ç­–é‡‘åˆ©ã‚„æµå‹•æ€§ä¾›çµ¦ï¼‰ã‚’æ‹…ã†ä¸­å¤®éŠ€è¡Œ</span></label>
  <label class="choice"><input type="radio" name="Q2" value="b"> <span data-i18n="Q2_b">B. ä¸Šå ´ä¼æ¥­ã®ç›£æŸ»ã‚’å°‚é–€ã¨ã™ã‚‹å›½éš›æ©Ÿé–¢</span></label>
  <label class="choice"><input type="radio" name="Q2" value="c"> <span data-i18n="Q2_c">C. å„å›½ã®è²¡æ”¿èµ¤å­—ã®ç®¡ç†ã‚’æ‹…å½“ã™ã‚‹è²¡å‹™çœ</span></label>
    </fieldset>
    <div class="explain" id="exp-Q2">
      <strong>è§£èª¬:</strong> ECB ã¯ãƒ¦ãƒ¼ãƒ­åœã®ä¸­å¤®éŠ€è¡Œã€‚MRO ã‚„ DFR ãªã©ã®æ”¿ç­–é‡‘åˆ©ã‚’æ±ºã‚ã€ç‰©ä¾¡å®‰å®šã‚’ç›®æŒ‡ã™ã€‚
    </div>
  </div>
</article>

<!-- Q3 -->
<article class="q card" data-id="Q3" data-type="mc" data-answer="c">
  <header>
    <h4 data-i18n="Q3_h">Q3: BSI ã¯ä½•ã®ç•¥ã§ã€ä¸»ã«ä½•ã‚’æ‰±ã†ï¼Ÿ</h4>
    <span class="type" data-i18n="Q3_type">Type: Multiple Choice</span>
  </header>
  <div class="body">
    <fieldset class="choices">
  <label class="choice"><input type="radio" name="Q3" value="a"> <span data-i18n="Q3_a">A. Bond Spread Indexã€‚å›½å‚µã¨ç¤¾å‚µã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æŒ‡æ•°</span></label>
  <label class="choice"><input type="radio" name="Q3" value="b"> <span data-i18n="Q3_b">B. Banking Stability Indicatorã€‚é‡‘èå®‰å®šåŒ–æŒ‡æ¨™</span></label>
  <label class="choice"><input type="radio" name="Q3" value="c"> <span data-i18n="Q3_c">C. Banking <em>Statistics</em> Itemsã€‚éŠ€è¡Œã®è²¸å€Ÿå¯¾ç…§è¡¨çµ±è¨ˆ</span></label>
    </fieldset>
    <div class="explain" id="exp-Q3">
      <strong>è§£èª¬:</strong> BSIï¼ˆBanking Statisticsï¼‰ã¯ã€è²¸å‡ºãƒ»é é‡‘ãªã©ã®ã€Œæ®‹é«˜ï¼ˆOutstandingï¼‰ã€ã‚’ä¸­å¿ƒã«ã‚«ãƒãƒ¼ã™ã‚‹ ECB çµ±è¨ˆã€‚
    </div>
  </div>
</article>

<!-- Q4 -->
<article class="q card" data-id="Q4" data-type="mc" data-answer="b">
  <header>
    <h4 data-i18n="Q4_h">Q4: â€œCurrency and Depositsï¼ˆé€šè²¨ï¼‹é é‡‘ï¼‰â€ ã¨ã¯ï¼Ÿ</h4>
    <span class="type" data-i18n="Q4_type">Type: Multiple Choice</span>
  </header>
  <div class="body">
    <fieldset class="choices">
  <label class="choice"><input type="radio" name="Q4" value="a"> <span data-i18n="Q4_a">A. æœ‰ä¾¡è¨¼åˆ¸ï¼‹ãƒ‡ãƒªãƒãƒ†ã‚£ãƒ–</span></label>
  <label class="choice"><input type="radio" name="Q4" value="b"> <span data-i18n="Q4_b">B. ç¾é‡‘ãƒ»å½“åº§ãƒ»æ™®é€šãƒ»å®šæœŸãªã©æµå‹•æ€§ã®é«˜ã„é é‡‘ç­‰ã®åˆè¨ˆ</span></label>
  <label class="choice"><input type="radio" name="Q4" value="c"> <span data-i18n="Q4_c">C. ä½å®…ãƒ­ãƒ¼ãƒ³ã¨ä¼æ¥­å‘ã‘ãƒ­ãƒ¼ãƒ³</span></label>
    </fieldset>
    <div class="explain" id="exp-Q4">
      <strong>è§£èª¬:</strong> â€œé€šè²¨ï¼‹é é‡‘â€ ã¯ã‚‚ã£ã¨ã‚‚æµå‹•æ€§ã®é«˜ã„è³‡ç”£ç¾¤ã€‚BSI ã®éƒ¨é–€åˆ¥æ®‹é«˜ã§é »å‡ºã€‚
    </div>
  </div>
</article>

<!-- Q5 (Multi-select) -->
<article class="q card" data-id="Q5" data-type="ms" data-answer="a,c">
  <header>
    <h4>Q5: æ¬¡ã®ã†ã¡ â€œéé‡‘èæ³•äººï¼ˆNFCï¼‰â€ ã«å½“ã¦ã¯ã¾ã‚‹ã®ã¯ï¼Ÿï¼ˆè¤‡æ•°é¸æŠï¼‰</h4>
    <span class="type">Type: Multi-Select</span>
  </header>
  <div class="body">
    <fieldset class="choices">
      <label class="choice"><input type="checkbox" name="Q5" value="a"> A. è£½é€ æ¥­ã®ä¼æ¥­</label>
      <label class="choice"><input type="checkbox" name="Q5" value="b"> B. æŠ•è³‡ä¿¡è¨—</label>
      <label class="choice"><input type="checkbox" name="Q5" value="c"> C. ã‚µãƒ¼ãƒ“ã‚¹æ¥­ã®ä¼æ¥­</label>
      <label class="choice"><input type="checkbox" name="Q5" value="d"> D. å¹´é‡‘åŸºé‡‘</label>
    </fieldset>
    <div class="explain" id="exp-Q5">
      <strong>è§£èª¬:</strong> NFC ã¯é‡‘èä»¥å¤–ã®ä¼æ¥­ï¼ˆè£½é€ ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ç­‰ï¼‰ã€‚æŠ•ä¿¡ã‚„å¹´é‡‘ã¯ â€œãã®ä»–ã®é‡‘èæ©Ÿé–¢ï¼ˆOFI/ICPFï¼‰â€ã€‚
    </div>
  </div>
</article>

<!-- Q6 -->
<article class="q card" data-id="Q6" data-type="mc" data-answer="c">
  <header>
    <h4>Q6: M3 ã®èª¬æ˜ã¨ã—ã¦æœ€é©ãªã®ã¯ï¼Ÿ</h4>
    <span class="type">Type: Multiple Choice</span>
  </header>
  <div class="body">
    <fieldset class="choices">
      <label class="choice"><input type="radio" name="Q6" value="a"> A. æ”¿åºœã®è²¡æ”¿èµ¤å­—ã®åˆè¨ˆ</label>
      <label class="choice"><input type="radio" name="Q6" value="b"> B. éŠ€è¡Œã®è‡ªå·±è³‡æœ¬ï¼ˆCET1ï¼‰</label>
      <label class="choice"><input type="radio" name="Q6" value="c"> C. ç¾é‡‘ï¼‹å„ç¨®é é‡‘ï¼‹è¿‘ä¼¼è³‡ç”£ã‚’å«ã‚€ â€œåºƒã„ãŠé‡‘â€ ã®é‡</label>
    </fieldset>
    <div class="explain" id="exp-Q6">
      <strong>è§£èª¬:</strong> M3 ã¯ãƒãƒãƒ¼ã‚¹ãƒˆãƒƒã‚¯ã®ä»£è¡¨ã€‚é•·æœŸãƒ»å®‰å®šã§æ™¯æ°—ã¨ã®é–¢é€£ã‚‚ç ”ç©¶ã•ã‚Œã‚‹ã€‚
    </div>
  </div>
</article>

<!-- Q7 -->
<article class="q card" data-id="Q7" data-type="mc" data-answer="a">
  <header>
    <h4>Q7: â€œãƒ¦ãƒ¼ãƒ­ã‚·ã‚¹ãƒ†ãƒ ã®ãƒãƒ©ãƒ³ã‚¹ã‚·ãƒ¼ãƒˆï¼ˆç·è³‡ç”£ï¼‰â€ ã¯ä½•ã® proxyï¼Ÿ</h4>
    <span class="type">Type: Multiple Choice</span>
  </header>
  <div class="body">
    <fieldset class="choices">
      <label class="choice"><input type="radio" name="Q7" value="a"> A. ä¸­å¤®éŠ€è¡Œã®æµå‹•æ€§ä¾›çµ¦è¦æ¨¡ï¼ˆãƒãƒã‚¿ãƒªãƒ¼ãƒ™ãƒ¼ã‚¹ã®è¿‘ä¼¼ï¼‰</label>
      <label class="choice"><input type="radio" name="Q7" value="b"> B. ä¸Šå ´ä¼æ¥­ã®åˆ©ç›Šç‡ã®å¹³å‡</label>
      <label class="choice"><input type="radio" name="Q7" value="c"> C. å®¶è¨ˆã®å¹³å‡è²¯è“„ç‡</label>
    </fieldset>
    <div class="explain" id="exp-Q7">
      <strong>è§£èª¬:</strong> ECB ç·è³‡ç”£ã®æ‹¡å¤§ã¯ç·©å’Œã®å¼·ã•ã®ä¸€ã¤ã®ç›®å®‰ã€‚é‡çš„ç·©å’ŒæœŸã«é¡•è‘—ã€‚
    </div>
  </div>
</article>

<!-- Q8 -->
<article class="q card" data-id="Q8" data-type="mc" data-answer="b">
  <header>
    <h4>Q8: â€œLoans outstandingâ€ ã¯ä½•ã‚’æŒ‡ã™ï¼Ÿ</h4>
    <span class="type">Type: Multiple Choice</span>
  </header>
  <div class="body">
    <fieldset class="choices">
      <label class="choice"><input type="radio" name="Q8" value="a"> A. å½“æœˆã«æ–°è¦ã«è²¸ã—ãŸé‡‘é¡ã ã‘</label>
      <label class="choice"><input type="radio" name="Q8" value="b"> B. æœŸæœ«æ™‚ç‚¹ã§ã¾ã è¿”æ¸ˆã•ã‚Œã¦ã„ãªã„è²¸å‡ºæ®‹é«˜ã®åˆè¨ˆ</label>
      <label class="choice"><input type="radio" name="Q8" value="c"> C. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã—ãŸè²¸å‡ºã ã‘</label>
    </fieldset>
    <div class="explain" id="exp-Q8">
      <strong>è§£èª¬:</strong> Outstanding ã¯ã€Œç´¯ç©ã—ã¦æ®‹ã£ã¦ã„ã‚‹é‡‘é¡ã€ã€‚æ–°è¦ãƒ•ãƒ­ãƒ¼ã¨ã¯åˆ¥æ¦‚å¿µã€‚
    </div>
  </div>
</article>

<!-- Q9 -->
<article class="q card" data-id="Q9" data-type="mc" data-answer="c">
  <header>
    <h4>Q9: â€œYieldï¼ˆåˆ©å›ã‚Šï¼‰â€ ã®ç°¡æ½”ãªå®šç¾©ã¯ï¼Ÿ</h4>
    <span class="type">Type: Multiple Choice</span>
  </header>
  <div class="body">
    <fieldset class="choices">
      <label class="choice"><input type="radio" name="Q9" value="a"> A. æ ªä¾¡ã®ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£</label>
      <label class="choice"><input type="radio" name="Q9" value="b"> B. åç›®GDPæˆé•·ç‡</label>
      <label class="choice"><input type="radio" name="Q9" value="c"> C. å‚µåˆ¸ãªã©ã‹ã‚‰å¾—ã‚‰ã‚Œã‚‹åç›Šç‡</label>
    </fieldset>
    <div class="explain" id="exp-Q9">
      <strong>è§£èª¬:</strong> ä¾‹ï¼š10å¹´å›½å‚µåˆ©å›ã‚Šã€‚å¸‚å ´é‡‘åˆ©ã‚„æœŸå¾…ã‚¤ãƒ³ãƒ•ãƒ¬ã®å½±éŸ¿ã‚’å—ã‘ã‚‹ã€‚
    </div>
  </div>
</article>

<!-- Q10 -->
<article class="q card" data-id="Q10" data-type="mc" data-answer="b">
  <header>
    <h4>Q10: â€œã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰â€ ã®è‡ªç„¶ãªå®šç¾©ã¯ï¼Ÿ</h4>
    <span class="type">Type: Multiple Choice</span>
  </header>
  <div class="body">
    <fieldset class="choices">
      <label class="choice"><input type="radio" name="Q10" value="a"> A. æ”¿ç­–é‡‘åˆ© âˆ’ å›½å‚µåˆ©å›ã‚Š</label>
      <label class="choice"><input type="radio" name="Q10" value="b"> B. ä¼æ¥­å‚µã®åˆ©å›ã‚Š âˆ’ åŒæœŸé–“ã®å›½å‚µåˆ©å›ã‚Š</label>
      <label class="choice"><input type="radio" name="Q10" value="c"> C. é é‡‘é‡‘åˆ© âˆ’ è²¸å‡ºé‡‘åˆ©</label>
    </fieldset>
    <div class="explain" id="exp-Q10">
      <strong>è§£èª¬:</strong> ãƒªã‚¹ã‚¯ãŒé«˜ã„ã»ã©ä¼æ¥­å‚µã®è¦æ±‚åˆ©å›ã‚ŠãŒä¸ŠãŒã‚Šã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ãŒæ‹¡å¤§ã™ã‚‹ã€‚
    </div>
  </div>
</article>

<!-- Q11 -->
<article class="q card" data-id="Q11" data-type="mc" data-answer="a">
  <header>
    <h4>Q11: MIR ã¯ä½•ã®çµ±è¨ˆï¼Ÿ</h4>
    <span class="type">Type: Multiple Choice</span>
  </header>
  <div class="body">
    <fieldset class="choices">
      <label class="choice"><input type="radio" name="Q11" value="a"> A. éŠ€è¡Œã®è²¸å‡ºé‡‘åˆ©ãƒ»é é‡‘é‡‘åˆ©ã®çµ±è¨ˆ</label>
      <label class="choice"><input type="radio" name="Q11" value="b"> B. æ ªå¼å¸‚å ´ã®å›è»¢ç‡</label>
      <label class="choice"><input type="radio" name="Q11" value="c"> C. ä½å®…ä¾¡æ ¼æŒ‡æ•°</label>
    </fieldset>
    <div class="explain" id="exp-Q11">
      <strong>è§£èª¬:</strong> ECB ã® MIR ã¯ã€å®¶è¨ˆãƒ»ä¼æ¥­å‘ã‘ã®è²¸å‡ºé‡‘åˆ©ï¼é é‡‘é‡‘åˆ©ã‚’è¦‹ã‚‹ã¨ãã«ä½¿ã†ã€‚
    </div>
  </div>
</article>

<!-- Q12 (Multi-select) -->
<article class="q card" data-id="Q12" data-type="ms" data-answer="a,c">
  <header>
    <h4>Q12: â€œdepthï¼ˆå¸‚å ´ã®åšã¿ï¼‰â€ ã® proxy ã¨ã—ã¦é©åˆ‡ãªã‚‚ã®ã¯ï¼Ÿï¼ˆè¤‡æ•°é¸æŠï¼‰</h4>
    <span class="type">Type: Multi-Select</span>
  </header>
  <div class="body">
    <fieldset class="choices">
      <label class="choice"><input type="checkbox" name="Q12" value="a"> A. æ°‘é–“å‘ã‘ãƒ­ãƒ¼ãƒ³æ®‹é«˜ï¼ˆECB BSIï¼‰</label>
      <label class="choice"><input type="checkbox" name="Q12" value="b"> B. ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã ã‘</label>
      <label class="choice"><input type="checkbox" name="Q12" value="c"> C. å‚µåˆ¸ Outstandingï¼ˆBISï¼‰</label>
      <label class="choice"><input type="checkbox" name="Q12" value="d"> D. ä¸€ç¤¾ã®æ™‚ä¾¡ç·é¡ã®ã¿</label>
    </fieldset>
    <div class="explain" id="exp-Q12">
      <strong>è§£èª¬:</strong> åšã¿ï¼è¦æ¨¡ã‚„æ®‹é«˜ã®å¤§ãã•ã€‚ECB ã®ãƒ­ãƒ¼ãƒ³æ®‹é«˜ã‚„ BIS ã®å‚µåˆ¸ Outstanding ã¯è‡ªç„¶ãªä»£ç†å¤‰æ•°ã€‚
    </div>
  </div>
</article>

<!-- Q13 -->
<article class="q card" data-id="Q13" data-type="mc" data-answer="b">
  <header>
    <h4>Q13: â€œTurnoverï¼ˆå›è»¢ç‡ï¼‰â€ ã¯é€šå¸¸ã©ã®å¸‚å ´ã§ä½¿ã†ï¼Ÿ</h4>
    <span class="type">Type: Multiple Choice</span>
  </header>
  <div class="body">
    <fieldset class="choices">
      <label class="choice"><input type="radio" name="Q13" value="a"> A. ä¸å‹•ç”£å¸‚å ´</label>
      <label class="choice"><input type="radio" name="Q13" value="b"> B. æ ªå¼å¸‚å ´ï¼ˆå£²è²·ä»£é‡‘ Ã· æ™‚ä¾¡ç·é¡ ãªã©ï¼‰</label>
      <label class="choice"><input type="radio" name="Q13" value="c"> C. é›‡ç”¨å¸‚å ´</label>
    </fieldset>
    <div class="explain" id="exp-Q13">
      <strong>è§£èª¬:</strong> WDI ã® â€œStock market turnover ratioâ€ ãŒä»£è¡¨ä¾‹ã€‚å£²è²·ã®æ´»ç™ºã•ã‚’è¡¨ã™ã€‚
    </div>
  </div>
</article>

<!-- Q14 (Multi-select) -->
<article class="q card" data-id="Q14" data-type="ms" data-answer="a,c">
  <header>
    <h4>Q14: ECB ã®ä¸»è¦ãªæ”¿ç­–é‡‘åˆ©ã«å«ã¾ã‚Œã‚‹ã‚‚ã®ã¯ï¼Ÿï¼ˆè¤‡æ•°é¸æŠï¼‰</h4>
    <span class="type">Type: Multi-Select</span>
  </header>
  <div class="body">
    <fieldset class="choices">
      <label class="choice"><input type="checkbox" name="Q14" value="a"> A. Deposit Facility Rateï¼ˆDFRï¼‰</label>
      <label class="choice"><input type="checkbox" name="Q14" value="b"> B. Federal Funds Rateï¼ˆç±³å›½ï¼‰</label>
      <label class="choice"><input type="checkbox" name="Q14" value="c"> C. Main Refinancing Operationsï¼ˆMROï¼‰</label>
      <label class="choice"><input type="checkbox" name="Q14" value="d"> D. å›½å‚µåˆ©å›ã‚Šï¼ˆå¸‚å ´ã§æ±ºã¾ã‚‹ï¼‰</label>
    </fieldset>
    <div class="explain" id="exp-Q14">
      <strong>è§£èª¬:</strong> ECB å›ºæœ‰ã¯ DFR ã‚„ MROã€‚ç±³å›½ã® FFR ã‚„å¸‚å ´ã®å›½å‚µåˆ©å›ã‚Šã¨ã¯åŒºåˆ¥ã™ã‚‹ã€‚
    </div>
  </div>
</article>

<!-- Q15 (Short Text: regex) -->
<article class="q card" data-id="Q15" data-type="text" data-eval="regex" data-answer="^Q-?DEC$">
  <header>
    <h4>Q15: å››åŠæœŸæœ«ã®é›†è¨ˆæ–¹å¼ã§ â€œ12æœˆæœŸã®å››åŠæœŸåŒºåˆ‡ã‚Šâ€ ã‚’æŒ‡ã™ç•¥ç§°ã¯ï¼Ÿï¼ˆå³å¯†ä¸€è‡´ï¼‰</h4>
    <span class="type">Type: Short Text</span>
  </header>
  <div class="body">
    <p>ãƒã‚¤ãƒ•ãƒ³æœ‰ã‚Šç„¡ã—ã©ã¡ã‚‰ã§ã‚‚å¯ã€‚</p>
    <input type="text" inputmode="text" autocomplete="off" name="Q15" aria-label="Q15 å…¥åŠ›" placeholder="ä¾‹: Q-DEC">
    <div class="explain" id="exp-Q15"><strong>è§£èª¬:</strong> Q-DEC ã¯ 3/6/9/12 æœˆã®åŒºåˆ‡ã‚Šã§å››åŠæœŸæœ«ã‚’ã¨ã‚‹æ–¹å¼ã€‚</div>
  </div>
</article>

<!-- Q16 (Short Text: regex) -->
<article class="q card" data-id="Q16" data-type="text" data-eval="regex" data-answer="ã™ã.*ç¾é‡‘.*å¤‰ãˆ|ç¾é‡‘åŒ–.*ã—ã‚„ã™|convert.*cash">
  <header>
    <h4>Q16: â€œæµå‹•æ€§ï¼ˆLiquidityï¼‰â€ ã‚’ä¸€è¨€ã§ã€‚</h4>
    <span class="type">Type: Short Text</span>
  </header>
  <div class="body">
    <p>æ—¥æœ¬èªã§ OKï¼ˆä¾‹ï¼šã€Œã™ãç¾é‡‘ã«å¤‰ãˆã‚‰ã‚Œã‚‹åº¦åˆã„ã€ï¼‰ã€‚</p>
    <input type="text" inputmode="text" autocomplete="off" name="Q16" aria-label="Q16 å…¥åŠ›" placeholder="ã“ã“ã«å…¥åŠ›">
    <div class="explain" id="exp-Q16"><strong>è§£èª¬:</strong> æµå‹•æ€§ã¯ â€œç¾é‡‘åŒ–ã®ã—ã‚„ã™ã•â€ã€‚QTC ã®æ¸©åº¦ã‚¢ãƒŠãƒ­ã‚¸ãƒ¼ã§ã¯ â€œå‹•ãã‚„ã™ã•â€ã€‚</div>
  </div>
</article>
</section>

    <div class="card panel" id="bottom-actions">
      <div class="row" style="justify-content:flex-end">
        <button class="btn success" id="bottomShowAnswers">è§£ç­”ã¨ã‚¹ã‚³ã‚¢ã‚’è¡¨ç¤º</button>
      </div>
    </div>

    <!-- ================== FOOTER ========================================== -->
    <footer class="muted" style="margin-top:24px">
      <p data-i18n="footer_text">ã“ã®ãƒšãƒ¼ã‚¸ã¯ <strong id="footer-skill">[SKILL_NAME]</strong> ã‚’ â€œ<em id="footer-goal">[GOAL_DESCRIPTION]</em>â€ ãƒ¬ãƒ™ãƒ«ã¸å°ããŸã‚ã® <em>LEARNING FIRST</em> ãƒ‰ãƒªãƒ«ã§ã‚ã‚‹ã€‚å¾—ç‚¹ã§ã¯ãªãç†è§£ã®æ·±ã•ã‚’é‡è¦–ã™ã‚‹ã“ã¨ã€‚</p>
      <p style="margin:.4rem 0 0"><span id="footer-brand"></span> <span id="copyright"></span></p>
    </footer>
  </div>

  <script>
  (function(){
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const THEME_KEY = 'quizTheme';
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');

    // Per-choice explanations (JA)
    const CHOICE_EXPLANATIONS = {
      Q1: {
        a: 'ãƒ•ãƒ­ãƒ¼ã€‚æœŸé–“ä¸­ã®æ–°è¦å–å¼•é¡ã€‚æ®‹é«˜ï¼ˆã‚¹ãƒˆãƒƒã‚¯ï¼‰ã¨ã¯åˆ¥ã€‚',
        b: 'æ­£è§£ã€‚æœŸæœ«ãªã©ã®æ™‚ç‚¹ã«æ®‹ã£ã¦ã„ã‚‹ç´¯ç©æ®‹é«˜ã‚’æŒ‡ã™ã€‚',
        c: 'æ”¿ç­–é‡‘åˆ©ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã§ã‚ã‚Šã€Outstanding ã®æ¦‚å¿µã¨ã¯ç„¡é–¢ä¿‚ã€‚'
      },
      Q2: {
        a: 'æ­£è§£ã€‚ãƒ¦ãƒ¼ãƒ­åœã®ä¸­å¤®éŠ€è¡Œã¨ã—ã¦æ”¿ç­–é‡‘åˆ©ã‚„æµå‹•æ€§ä¾›çµ¦ã‚’æ‹…ã†ã€‚',
        b: 'ç›£æŸ»ã¯ç›£æŸ»æ³•äººã‚„å„å›½å½“å±€ã®å½¹å‰²ã§ã€ECB ã®ä¸»æ¥­å‹™ã§ã¯ãªã„ã€‚',
        c: 'è²¡æ”¿èµ¤å­—ã®ç®¡ç†ã¯å„å›½ã®è²¡å‹™çœãƒ»æ”¿åºœã®å½¹å‰²ã€‚'
      },
      Q3: {
        a: 'ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æŒ‡æ•°ã§ã¯ãªã„ã€‚',
        b: 'é‡‘èå®‰å®šã®æŒ‡æ¨™åã«ä¼¼ã¦ã„ã‚‹ãŒ BSI ã¨ã¯åˆ¥ç‰©ã€‚',
        c: 'æ­£è§£ã€‚éŠ€è¡Œçµ±è¨ˆï¼ˆè²¸å€Ÿå¯¾ç…§è¡¨é …ç›®ï¼‰ã§æ®‹é«˜ä¸­å¿ƒã«æ‰±ã†ã€‚'
      },
      Q4: {
        a: 'è¨¼åˆ¸ã‚„ãƒ‡ãƒªãƒãƒ†ã‚£ãƒ–ã¯å«ã¾ãªã„ã€‚',
        b: 'æ­£è§£ã€‚ç¾é‡‘ã¨æµå‹•æ€§ã®é«˜ã„å„ç¨®é é‡‘ã®ã¾ã¨ã¾ã‚Šã€‚',
        c: 'ãƒ­ãƒ¼ãƒ³ã¯â€œè²¸å‡ºâ€ã§ã‚ã‚Šé€šè²¨ï¼‹é é‡‘ã§ã¯ãªã„ã€‚'
      },
      Q5: {
        a: 'æ­£è§£ã€‚é‡‘èä»¥å¤–ã®ä¼æ¥­ï¼ˆè£½é€ æ¥­ï¼‰ã¯ NFC ã«è©²å½“ã€‚',
        b: 'æŠ•è³‡ä¿¡è¨—ã¯é‡‘èæ©Ÿé–¢ï¼ˆOFIï¼‰ã«åŒºåˆ†ã•ã‚Œã‚‹ã€‚',
        c: 'æ­£è§£ã€‚ã‚µãƒ¼ãƒ“ã‚¹æ¥­ãªã©ã‚‚ NFCã€‚',
        d: 'å¹´é‡‘åŸºé‡‘ã¯ ICPFï¼ˆä¿é™ºãƒ»å¹´é‡‘ï¼‰ã«åŒºåˆ†ã€‚'
      },
      Q6: {
        a: 'è²¡æ”¿èµ¤å­—ã®åˆè¨ˆã§ã¯ãªã„ã€‚',
        b: 'è‡ªå·±è³‡æœ¬ï¼ˆCET1ï¼‰ã§ã¯ãªã„ã€‚',
        c: 'æ­£è§£ã€‚ç¾é‡‘ï¼‹å„ç¨®é é‡‘ï¼‹è¿‘ä¼¼è³‡ç”£ã‚’å«ã‚€åºƒç¾©ã®ãƒãƒãƒ¼ã€‚'
      },
      Q7: {
        a: 'æ­£è§£ã€‚ä¸­å¤®éŠ€è¡Œã®æµå‹•æ€§ä¾›çµ¦è¦æ¨¡ï¼ˆMB ã®è¿‘ä¼¼ï¼‰ã‚’è¦‹ã‚‹ç›®å®‰ã€‚',
        b: 'ä¼æ¥­ã®åˆ©ç›Šç‡ã¨ã¯é–¢ä¿‚ã—ãªã„ã€‚',
        c: 'å®¶è¨ˆã®è²¯è“„ç‡ã¨ã¯åˆ¥æ¦‚å¿µã€‚'
      },
      Q8: {
        a: 'å½“æœˆã®æ–°è¦è²¸å‡ºã ã‘ã§ã¯ãªã„ã€‚',
        b: 'æ­£è§£ã€‚æœŸæœ«ã¾ã§ã«æœªè¿”æ¸ˆã®è²¸å‡ºæ®‹é«˜ã®åˆè¨ˆã€‚',
        c: 'ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè²¸å‡ºã ã‘ã‚’æŒ‡ã™ã‚ã‘ã§ã¯ãªã„ã€‚'
      },
      Q9: {
        a: 'ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆå¤‰å‹•ç‡ï¼‰ã®ã“ã¨ã§ã¯ãªã„ã€‚',
        b: 'GDP æˆé•·ç‡ã§ã¯ãªã„ã€‚',
        c: 'æ­£è§£ã€‚å‚µåˆ¸ç­‰ã‹ã‚‰å¾—ã‚‰ã‚Œã‚‹åç›Šç‡ï¼ˆåˆ©å›ã‚Šï¼‰ã€‚'
      },
      Q10: {
        a: 'æ”¿ç­–é‡‘åˆ©ã¨å›½å‚µåˆ©å›ã‚Šã®å·®ã§ã¯ãªã„ã€‚',
        b: 'æ­£è§£ã€‚ä¼æ¥­å‚µã®åˆ©å›ã‚Š âˆ’ åŒæœŸé–“ã®å›½å‚µåˆ©å›ã‚Šã€‚',
        c: 'é é‡‘ã¨è²¸å‡ºã®é‡‘åˆ©å·®ï¼ˆNIMï¼‰ã§ã¯ãªã„ã€‚'
      },
      Q11: {
        a: 'æ­£è§£ã€‚å®¶è¨ˆãƒ»ä¼æ¥­å‘ã‘ã®è²¸å‡ºãƒ»é é‡‘é‡‘åˆ©ã®çµ±è¨ˆã€‚',
        b: 'å›è»¢ç‡ã¯ä¸»ã«æ ªå¼å¸‚å ´ã®æŒ‡æ¨™ã€‚',
        c: 'ä½å®…ä¾¡æ ¼æŒ‡æ•°ã§ã¯ãªã„ã€‚'
      },
      Q12: {
        a: 'æ­£è§£ã€‚æ®‹é«˜ã®å¤§ãã•ã¯åšã¿ã‚’è¡¨ã™ã€‚',
        b: 'ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã ã‘ã§ã¯åšã¿ã‚’è¡¨ã›ãªã„ã€‚',
        c: 'æ­£è§£ã€‚å‚µåˆ¸ Outstanding ã¯å¸‚å ´è¦æ¨¡ï¼ˆåšã¿ï¼‰ã®æŒ‡æ¨™ã€‚',
        d: 'ä¸€ç¤¾ã ã‘ã§ã¯å¸‚å ´å…¨ä½“ã®åšã¿ã‚’ä»£è¡¨ã§ããªã„ã€‚'
      },
      Q13: {
        a: 'ä¸å‹•ç”£å¸‚å ´ã§ã¯ä¸€èˆ¬çš„ã§ã¯ãªã„ã€‚',
        b: 'æ­£è§£ã€‚æ ªå¼å¸‚å ´ã§å£²è²·ã®æ´»ç™ºã•ã‚’æ¸¬ã‚‹æ¯”ç‡ã€‚',
        c: 'é›‡ç”¨å¸‚å ´ã®æŒ‡æ¨™ã§ã¯ãªã„ã€‚'
      },
      Q14: {
        a: 'æ­£è§£ã€‚DFR ã¯ä¸»è¦æ”¿ç­–é‡‘åˆ©ã®ä¸€ã¤ã€‚',
        b: 'ç±³å›½ã®æ”¿ç­–é‡‘åˆ©ï¼ˆFFRï¼‰ã§ ECB ã§ã¯ãªã„ã€‚',
        c: 'æ­£è§£ã€‚MRO ã¯ä¸»è¦æ”¿ç­–é‡‘åˆ©ã®ä¸€ã¤ã€‚',
        d: 'å›½å‚µåˆ©å›ã‚Šã¯å¸‚å ´ã§æ±ºã¾ã‚‹é‡‘åˆ©ã§æ”¿ç­–é‡‘åˆ©ã§ã¯ãªã„ã€‚'
      }
    };

    // Rich notes (èƒŒæ™¯ãƒ»å…¨ä½“åƒã®ç†è§£ç”¨)
    const DETAIL_NOTES = {
      Q1: '<div class="muted"><p><strong>èƒŒæ™¯:</strong> Outstanding ã¯æœŸæœ«æ®‹é«˜ã¨ã„ã†ã€ŒçŠ¶æ…‹ã€ã€‚ãƒ•ãƒ­ãƒ¼ï¼ˆæœˆé–“æ–°è¦å–å¼•ï¼‰ã¨ã¯åˆ¥è»¸ã§ã™ã€‚</p><ul><li>ä¼šè¨ˆã§ã¯ã‚¹ãƒˆãƒƒã‚¯ï¼ˆè²¸å€Ÿå¯¾ç…§è¡¨ï¼‰ã«å¯¾å¿œã€ãƒ•ãƒ­ãƒ¼ï¼ˆæç›Š/è³‡é‡‘ç§»å‹•ï¼‰ã¨åŒºåˆ¥ã€‚</li><li>ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ: ECB BSI ã® "Outstanding amounts"ã€‚</li><li>å®Ÿå‹™: æ–°è¦ã¨è¿”æ¸ˆãŒåŒæ™‚ã«å¤§ãã„æœˆãŒã‚ã‚Šã†ã‚‹ãŸã‚ã€ãƒ•ãƒ­ãƒ¼â‰ æ®‹é«˜å¤‰åŒ–ã€‚</li></ul></div>',
      Q2: '<div class="muted"><p><strong>èƒŒæ™¯:</strong> ECB ã¯ç‰©ä¾¡å®‰å®šã‚’ä¸»ç›®çš„ã¨ã—ã€æ”¿ç­–é‡‘åˆ©ï¼ˆMRO/DFR ç­‰ï¼‰ã¨ã‚ªãƒšã§æµå‹•æ€§ã‚’èª¿æ•´ã€‚</p><ul><li>DFR ã¯ä¸‹é™é‡‘åˆ©ã€MRO ã¯ä¸»ãŸã‚‹æ“ä½œã€‚</li><li>è²¡æ”¿èµ¤å­—ã®ç®¡ç†ã¯æ”¿åºœã®å½¹å‰²ã€‚</li></ul></div>',
      Q3: '<div class="muted"><p><strong>èƒŒæ™¯:</strong> BSI ã¯éŠ€è¡Œã®ãƒãƒ©ãƒ³ã‚¹ã‚·ãƒ¼ãƒˆçµ±è¨ˆã€‚ã‚¹ãƒˆãƒƒã‚¯ä¸­å¿ƒã§éƒ¨é–€ãƒ»å•†å“åˆ¥ã«æ®‹é«˜ã‚’æŠŠæ¡ã€‚</p><ul><li>è²¸å‡º/é é‡‘/è¨¼åˆ¸ä¿æœ‰ãªã©ã€‚</li><li>é‡‘åˆ©ã¨ä¿¡ç”¨ã®é–¢ä¿‚ã‚’èª­ã‚€åŸºç›¤ãƒ‡ãƒ¼ã‚¿ã€‚</li></ul></div>',
      Q4: '<div class="muted"><p><strong>èƒŒæ™¯:</strong> é€šè²¨ï¼‹é é‡‘ã¯æœ€ã‚‚æµå‹•æ€§ãŒé«˜ã„è³‡ç”£ç¾¤ã€‚M3 ã®ä¸­æ ¸ã€‚</p></div>',
      Q5: '<div class="muted"><p><strong>èƒŒæ™¯:</strong> ã‚»ã‚¯ã‚¿ãƒ¼åˆ†é¡ã®åŸºç¤ã€‚NFC=éé‡‘èä¼æ¥­ã€‚æŠ•ä¿¡/å¹´é‡‘ã¯é‡‘èéƒ¨é–€ã€‚</p></div>',
      Q6: '<div class="muted"><p><strong>èƒŒæ™¯:</strong> M3 ã¯ã€Œåºƒã„ãŠé‡‘ã€ã€‚é‡‘èç’°å¢ƒã®åšã¿ã‚’ç¤ºã™ã€‚</p></div>',
      Q7: '<div class="muted"><p><strong>èƒŒæ™¯:</strong> ãƒ¦ãƒ¼ãƒ­ã‚·ã‚¹ãƒ†ãƒ ç·è³‡ç”£ã¯æµå‹•æ€§ä¾›çµ¦ã®è¦æ¨¡æ„Ÿã€‚é‡çš„ç·©å’Œã§æ‹¡å¤§ã€‚</p></div>',
      Q8: '<div class="muted"><p><strong>èƒŒæ™¯:</strong> è²¸å‡º Outstanding = æœªè¿”æ¸ˆæ®‹é«˜ã€‚æ–°è¦ã¨è¿”æ¸ˆã®å·®ã§å¤‰åŒ–ã€‚</p></div>',
      Q9: '<div class="muted"><p><strong>èƒŒæ™¯:</strong> åˆ©å›ã‚Šã¯æŠ•è³‡ã‹ã‚‰ã®åç›Šç‡ã€‚é‡‘åˆ©/ç‰©ä¾¡/ä¿¡ç”¨ã®æœŸå¾…ã‚’åæ˜ ã€‚</p></div>',
      Q10:'<div class="muted"><p><strong>èƒŒæ™¯:</strong> ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã¯ä¿¡ç”¨ãƒªã‚¹ã‚¯ã®ä½“æ¸©è¨ˆã€‚</p><ul><li>æ‹¡å¤§=ã‚¿ã‚¤ãƒˆåŒ–/ä¸ç¢ºå®Ÿæ€§ä¸Šæ˜‡</li><li>ç¸®å°=ãƒªã‚¹ã‚¯è¨±å®¹åº¦ä¸Šæ˜‡/ç·©å’Œ</li></ul></div>',
      Q11:'<div class="muted"><p><strong>èƒŒæ™¯:</strong> MIR ã¯å®¶è¨ˆ/ä¼æ¥­å‘ã‘é‡‘åˆ©ã®å®Ÿå‹¢ã€‚èª¿é”/é‹ç”¨ã‚³ã‚¹ãƒˆã‚’æŠŠæ¡ã€‚</p></div>',
      Q12:'<div class="muted"><p><strong>èƒŒæ™¯:</strong> åšã¿ã¯è¦æ¨¡ã€‚æ®‹é«˜ï¼ˆã‚¹ãƒˆãƒƒã‚¯ï¼‰ã§æ¸¬ã‚‹ã®ãŒè‡ªç„¶ã€‚</p></div>',
      Q13:'<div class="muted"><p><strong>èƒŒæ™¯:</strong> Turnover ã¯æ ªå¼å¸‚å ´ã®å£²è²·æ´»ç™ºåº¦ã€‚</p></div>',
      Q14:'<div class="muted"><p><strong>èƒŒæ™¯:</strong> ä¸»è¦æ”¿ç­–é‡‘åˆ©=DFR/MRO ç­‰ã€‚FFR ã¯ç±³å›½ã€å›½å‚µåˆ©å›ã‚Šã¯å¸‚å ´é‡‘åˆ©ã€‚</p></div>',
      Q15:'<div class="muted"><p><strong>å‚è€ƒ:</strong> Q-DEC ã¯å››åŠæœŸåŒºåˆ‡ã‚Šã®è¡¨è¨˜ï¼ˆ3/6/9/12ï¼‰ã€‚</p></div>',
      Q16:'<div class="muted"><p><strong>èƒŒæ™¯:</strong> æµå‹•æ€§=ç¾é‡‘åŒ–ã®ã—ã‚„ã™ã•ã€‚ä¾¡æ ¼ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆå°ã§å£²è²·ã§ãã‚‹ã‹ã‚‚å«æ„ã€‚</p></div>'
    };

    function updateThemeToggle(mode){
      const btn = $('#themeToggle');
      if(!btn) return;
      const isLight = mode === 'light';
      const next = isLight ? 'dark' : 'light';
      btn.dataset.next = next;
      btn.setAttribute('aria-pressed', isLight ? 'true' : 'false');
      btn.setAttribute('aria-label', next === 'dark' ? 'ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ' : 'ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ');
      const icon = next === 'dark' ? 'ğŸŒ™' : 'â˜€ï¸';
      const label = next === 'dark' ? 'ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰' : 'ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰';
      btn.innerHTML = '<span class="theme-icon" aria-hidden="true">' + icon + '</span><span class="theme-label">' + label + '</span>';
    }

    function setTheme(mode, persist=true){
      const normalized = mode === 'light' ? 'light' : 'dark';
      document.body.setAttribute('data-theme', normalized);
      if(persist){
        try{ localStorage.setItem(THEME_KEY, normalized); }catch(e){}
      }
      updateThemeToggle(normalized);
    }

    function applyInitialTheme(){
      let stored = null;
      try{ stored = localStorage.getItem(THEME_KEY); }catch(e){ stored = null; }
      const initial = stored || (prefersDark.matches ? 'dark' : 'light');
      setTheme(initial, false);
    }

    function toggleTheme(){
      const current = document.body.getAttribute('data-theme') === 'light' ? 'light' : 'dark';
      const next = current === 'light' ? 'dark' : 'light';
      setTheme(next, true);
    }

    // Apply settings to head titles and headings
    function applySettings(){
      const S = window.DRILL_SETTINGS || {};
      const name = S.SKILL_NAME || '[SKILL_NAME]';
      const sub = S.SKILL_SUBTITLE || '[SKILL_SUBTITLE]';
      const goal = S.GOAL_DESCRIPTION || '[GOAL_DESCRIPTION]';
      document.title = `${name} 101: ${sub}ï¼ˆå­¦ç¿’ãƒ‰ãƒªãƒ«ï¼‰`;
      $('#title').textContent = `${name} 101: ${sub}ï¼ˆå­¦ç¿’ãƒ‰ãƒªãƒ«ï¼‰`;
      $('#subtitle').textContent = `${name} ã‚’ã€Œ${goal}ã€ã¾ã§å¼•ãä¸Šã’ã‚‹ãŸã‚ã®ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ»ãƒ‰ãƒªãƒ«`;
      $('#footer-skill').textContent = name;
      $('#footer-goal').textContent = goal;
      // Brand
  const bName = S.BRAND_NAME || 'Toppy Microservices';
  const bLogo = S.BRAND_LOGO || '/toppy_bimi.svg';
  const bUrl  = S.BRAND_URL  || '/';
      $('#brand-name')?.textContent = bName;
      const blink = $('#brand-link'); if(blink) blink.setAttribute('href', bUrl);
      const img = $('#brand-logo'); if(img && bLogo){ img.src=bLogo; img.alt=bName; img.style.display='inline-block'; }
      const fb = $('#footer-brand'); if(fb){ fb.innerHTML = `<strong>${bName}</strong>` + (bUrl && bUrl!=='#' ? ` â€“ <a href="${bUrl}">${bUrl}</a>` : ''); }
      const year = new Date().getFullYear(); $('#copyright')?.textContent = `Â© ${year} ${bName}. All rights reserved.`;
      const lm = $('#learningMode');
      lm.checked = S.LEARNING_MODE_DEFAULT !== false;
      updateModeBadge();
    }

    function updateModeBadge(){
      const on = $('#learningMode').checked;
      const mb = $('#mode-badge');
      if(!mb) return;
      mb.textContent = on ? 'å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰' : 'ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰';
      mb.setAttribute('aria-pressed', on ? 'true' : 'false');
      mb.setAttribute('title', on ? 'ã‚¯ãƒªãƒƒã‚¯ã§ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ã¸' : 'ã‚¯ãƒªãƒƒã‚¯ã§å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã¸');
    }

    function showExplain(el, show=true){
      const exp = el.querySelector('.explain');
      if(!exp) return;
      exp.classList.toggle('show', !!show);
      // Inject per-choice explanations (once)
      if(show && !exp.dataset.choicesInjected){
        const qid = el.dataset.id;
        const map = CHOICE_EXPLANATIONS[qid];
        if(map){
          const gold = (el.dataset.answer||'').split(',').map(s=>s.trim());
          const box = document.createElement('div');
          box.className = 'muted';
          box.style.marginTop = '8px';
          let html = '<div style="font-weight:600;margin:4px 0 6px">é¸æŠè‚¢ã®èª¬æ˜</div><ul style="margin:0 0 0 1.1rem;line-height:1.5">';
          ['a','b','c','d','e'].forEach(k=>{
            if(map[k]){
              const mark = gold.includes(k) ? 'âœ…' : 'âœ–';
              html += '<li>'+mark+' '+k.toUpperCase()+'. '+map[k]+'</li>';
            }
          });
          html += '</ul>';
          box.innerHTML = html;
          exp.appendChild(box);
        }
        exp.dataset.choicesInjected = '1';
      }
      // Rich figures (Q1/Q10) once
      if(show && !exp.dataset.richInjected){
        const id = el.dataset.id;
        const svgQ1 = ()=>'<svg width="100%" height="70" viewBox="0 0 320 70" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Stock vs Flow"><defs><linearGradient id="gj1" x1="0" x2="1"><stop offset="0" stop-color="rgba(78,161,255,0.3)"/><stop offset="1" stop-color="rgba(155,227,127,0.25)"/></linearGradient></defs><rect x="8" y="14" width="136" height="36" rx="8" fill="url(#gj1)" stroke="rgba(78,161,255,0.6)"/><text x="76" y="36" text-anchor="middle" fill="currentColor" font-size="12">Stock</text><path d="M176 32 h70" stroke="rgba(78,161,255,0.8)" stroke-width="3"/><polygon points="246,32 236,27 236,37" fill="rgba(78,161,255,0.8)"/><text x="206" y="24" fill="currentColor" font-size="12">Flow</text></svg>';
        const svgQ10= ()=>'<svg width="100%" height="80" viewBox="0 0 360 80" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Credit spread"><line x1="40" y1="52" x2="320" y2="52" stroke="rgba(120,160,200,0.5)"/><polyline points="40,50 100,46 160,44 220,45 280,43 320,42" stroke="rgba(90,200,140,0.9)" fill="none" stroke-width="2"/><polyline points="40,36 100,32 160,28 220,30 280,28 320,27" stroke="rgba(80,140,255,0.95)" fill="none" stroke-width="2"/><path d="M160 44 v-12" stroke="rgba(255,255,255,0.7)" stroke-width="2"/><text x="170" y="38" fill="currentColor" font-size="12">spread</text><text x="8" y="30" fill="currentColor" font-size="12">Corp</text><text x="8" y="48" fill="currentColor" font-size="12">Gov</text></svg>';
        let fig=''; if(id==='Q1') fig=svgQ1(); if(id==='Q10') fig=svgQ10();
        if(fig){ const w=document.createElement('div'); w.className='muted'; w.style.marginTop='8px'; w.innerHTML=fig; exp.appendChild(w); }
        exp.dataset.richInjected='1';
      }

      // Detailed notes once
      if(show && !exp.dataset.notesInjected){
        const id = el.dataset.id; const html = DETAIL_NOTES[id];
        if(html){ const wrap=document.createElement('div'); wrap.innerHTML=html; exp.appendChild(wrap); }
        exp.dataset.notesInjected='1';
      }

      const btn = el.querySelector('.answer-btn');
      if(btn){
        btn.textContent = exp.classList.contains('show') ? 'è§£èª¬ã‚’éš ã™' : 'è§£ç­”ã‚’è¡¨ç¤º';
      }
    }

    // Evaluate a single question
    function evaluateQuestion(q){
      const id = q.dataset.id;
      const type = q.dataset.type;
      const ans = (q.dataset.answer||'').trim();
      let ok = null, user=null;

      if(type==='mc'){
        const picked = q.querySelector('input[type=radio]:checked');
        if(!picked){ ok = null; }
        else { user = picked.value; ok = (user === ans); markChoices(q, [user], ans.split(',')); }
      }
      else if(type==='ms'){
        const picked = q.querySelectorAll('input[type=checkbox]:checked');
        user = Array.from(picked).map(i=>i.value).sort();
        const gold = ans.split(',').map(s=>s.trim()).sort();
        ok = JSON.stringify(user)===JSON.stringify(gold);
        markChoices(q, user, gold);
      }
      else if(type==='classify'){
        // expected format: "group1:a,c;group2:b,d"
        const parse = s=>Object.fromEntries(s.split(';').map(p=>{const [g,l]=p.split(':'); return [g.trim(), (l?l.split(',').map(x=>x.trim()).filter(Boolean):[])];}));
        const goldMap = parse(ans);
        const groups = Object.keys(goldMap);
        const userMap = {};
        groups.forEach(g=>{
          const box = q.querySelector('.bucket[data-group="'+g+'"]');
          const vals = Array.from(box?.querySelectorAll('.chip')||[]).map(c=>c.dataset.value).filter(Boolean).sort();
          userMap[g] = vals;
        });
        const eq = (a,b)=>JSON.stringify((a||[]).slice().sort())===JSON.stringify((b||[]).slice().sort());
        ok = groups.every(g=>eq(userMap[g], goldMap[g]));
        user = groups.map(g=>g+':'+(userMap[g]||[]).join(',')).join(' | ');
      }
      else if(type==='segment'){
        const picked = q.dataset.segmentSelected || '';
        user = picked;
        ok = picked ? (picked===ans) : null;
      }
      else if(type==='text'){
        const input = q.querySelector('input[type=text]');
        user = (input?.value||'').trim();
        const mode = (q.dataset.eval||'exact').toLowerCase();
        if(mode==='regex'){
          try{
            const re = new RegExp(ans, 'i');
            ok = re.test(user);
          }catch(e){ ok = false; }
        } else {
          ok = (user === ans);
        }
      }

      return {id, ok, user, type};
    }

    function markChoices(q, userValues, goldValues){
      q.querySelectorAll('.choice').forEach(lbl=>{
        lbl.classList.remove('correct','wrong');
        const v = lbl.querySelector('input')?.value;
        if(!v) return;
        if(userValues?.includes(v)){
          lbl.classList.add(goldValues.includes(v)?'correct':'wrong');
        }
      });
    }

    function renderResults(){
      const rows = [];
      $$('#questions .q').forEach(q=>{
        const r = evaluateQuestion(q);
        const langEn = $('#lang-en').classList.contains('active');
        const state = r.ok===null ? (langEn? 'Unanswered':'æœªå›ç­”') : (r.ok? (langEn? 'Correct':'â—‹') : (langEn? 'Wrong':'Ã—'));
        rows.push(`<tr><td>${r.id}</td><td>${r.type}</td><td>${escapeHtml(r.user??'')}</td><td>${state}</td></tr>`);
      });
      const langEn = $('#lang-en').classList.contains('active');
      const html = `
        <h4 style="margin:0 0 8px">${langEn? 'Results (learning view)': 'é›†è¨ˆï¼ˆå­¦ç¿’ç”¨ï¼‰'}</h4>
        <table aria-label="çµæœãƒ†ãƒ¼ãƒ–ãƒ«">
          <thead><tr><th>${langEn? 'Q ID' : 'è¨­å•ID'}</th><th>${langEn? 'Type' : 'å½¢å¼'}</th><th>${langEn? 'Answer' : 'å›ç­”'}</th><th>${langEn? 'Result' : 'çµæœ'}</th></tr></thead>
          <tbody>${rows.join('')}</tbody>
        </table>`;
      const box = $('#results');
      box.innerHTML = html;
      box.style.display = 'block';
    }

    function escapeHtml(s){
      return s.replace(/[&<>"']/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m]));
    }

  function attachHandlers(){
      $('#themeToggle')?.addEventListener('click', ()=>{ toggleTheme(); updateLiveScore(); });
      // Language toggle handlers and translation map
      const S = window.DRILL_SETTINGS || {};
      const translations = {
        en: {
          title: (S.SKILL_NAME || 'Skill') + ' 101: ' + (S.SKILL_SUBTITLE || 'Subtitle') + ' (Drill)',
          subtitle: (S.SKILL_NAME || 'Skill') + ' â€“ a reading drill to reach: ' + (S.GOAL_DESCRIPTION || 'Goal'),
          scope_h: 'Scope',
          ops_h: 'Controls',
          learning_mode: 'Learning mode (show explanations on selection)',
          show_all: 'Show all explanations',
          hide_all: 'Hide all explanations',
          regen: 'Regenerate results table',
          learning_tip: '<strong>Learning tip:</strong> Aim to be able to explain concepts in your own words.',
          cheat_summary: 'Cheat Sheet: quick reference',
          footer_text: 'This page is a LEARNING-FIRST drill to take <strong>' + (S.SKILL_NAME || 'Skill') + '</strong> to the level <em>' + (S.GOAL_DESCRIPTION || 'Goal') + '</em>.',
          // Question translations (sample)
          Q1_h: 'Q1: What does â€œOutstandingâ€ most closely mean?',
          Q1_type: 'Type: Multiple Choice',
          Q1_a: 'A. Sum of new transactions during the month (flow)',
          Q1_b: 'B. Amount remaining outstanding at a point in time (stock)',
          Q1_c: 'C. Policy interest rate target',
          Q2_h: 'Q2: What is the role of the ECB (European Central Bank)?',
          Q2_type: 'Type: Multiple Choice',
          Q2_a: 'A. The central bank responsible for monetary policy in the euro area',
          Q2_b: 'B. An international body specialising in audits of listed firms',
          Q2_c: 'C. The ministry responsible for national fiscal deficits',
          Q3_h: 'Q3: What does BSI stand for and what does it mainly cover?',
          Q3_type: 'Type: Multiple Choice',
          Q3_a: 'A. Bond Spread Index',
          Q3_b: 'B. Banking Stability Indicator',
          Q3_c: 'C. Banking Statistics (balance sheet items)',
          Q4_h: 'Q4: What are â€œCurrency and Depositsâ€?',
          Q4_type: 'Type: Multiple Choice',
          Q4_a: 'A. Securities and derivatives',
          Q4_b: 'B. Cash and highly liquid deposits (current/savings/time)',
          Q4_c: 'C. Mortgage and corporate loans',
          mode_badge_test: 'Test mode',
          mode_badge_learn: 'Learning mode'
        }
      };

      function translatePage(lang){
        if(!lang) return;
        // UI strings (elements with data-i18n)
        $$('[data-i18n]').forEach(el=>{
          const key = el.getAttribute('data-i18n');
          if(translations[lang] && translations[lang][key]){
            if(el.tagName.toLowerCase()==='input' || el.tagName.toLowerCase()==='textarea') el.value = translations[lang][key];
            else el.innerHTML = translations[lang][key];
          }
        });
        // Mode badge
        $('#mode-badge').textContent = (lang==='en' && !$('#learningMode').checked) ? translations.en.mode_badge_test : (lang==='en' ? translations.en.mode_badge_learn : ($('#learningMode').checked ? 'å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰' : 'ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰'));
        // Update title element (also update document.title)
        if(lang==='en'){
          document.title = translations.en.title;
          $('#title').textContent = translations.en.title;
          $('#subtitle').textContent = translations.en.subtitle;
        } else {
          applySettings(); // restore Japanese defaults from settings
        }
      }

      // Hook language buttons
      $('#lang-ja').addEventListener('click', ()=>{
        $('#lang-ja').classList.add('active'); $('#lang-ja').setAttribute('aria-pressed','true');
        $('#lang-en').classList.remove('active'); $('#lang-en').setAttribute('aria-pressed','false');
        translatePage('ja');
      });
      $('#lang-en').addEventListener('click', ()=>{
        $('#lang-en').classList.add('active'); $('#lang-en').setAttribute('aria-pressed','true');
        $('#lang-ja').classList.remove('active'); $('#lang-ja').setAttribute('aria-pressed','false');
        translatePage('en');
      });

      // Learning mode toggle
      $('#learningMode').addEventListener('change', ()=>{
        updateModeBadge();
        if(!$('#learningMode').checked){ // hide all when switching to test mode
          $$('.explain').forEach(e=>e.classList.remove('show'));
        }
        updateLiveScore();
      });

      // Header badge also toggles learning mode
      const mb = $('#mode-badge');
      if(mb){
        const toggleMode = ()=>{
          const lm = $('#learningMode');
          lm.checked = !lm.checked;
          lm.dispatchEvent(new Event('change'));
        };
        mb.addEventListener('click', toggleMode);
        mb.addEventListener('keydown', (e)=>{
          if(e.key==='Enter' || e.key===' '){ e.preventDefault(); toggleMode(); }
        });
      }

  // Show/Hide all explanations
      $('#showAll').addEventListener('click', ()=> { $$('.explain').forEach(e=>e.classList.add('show')); updateLiveScore(); });
      $('#hideAll').addEventListener('click', ()=> { $$('.explain').forEach(e=>e.classList.remove('show')); updateLiveScore(); });
  $('#regen').addEventListener('click', renderResults);
  $('#showAnswersScore').addEventListener('click', showAnswersAndScore);
  $('#bottomShowAnswers')?.addEventListener('click', ()=>{
        showAnswersAndScore();
        const dd = document.querySelector('details.cheatsheet');
        if(dd){ dd.open = true; dd.scrollIntoView({behavior:'smooth', block:'nearest'}); }
  });

      // Per-question behavior
      $$('#questions .q').forEach(q=>{
        const type = q.dataset.type;
        if(type==='mc'){
          q.querySelectorAll('input[type=radio]').forEach(r=>{
            r.addEventListener('change', ()=>{
              evaluateQuestion(q);
              if($('#learningMode').checked){ showExplain(q, true); }
              updateLiveScore();
            });
          });
        } else if(type==='ms'){
          q.querySelectorAll('input[type=checkbox]').forEach(r=>{
            r.addEventListener('change', ()=>{
              evaluateQuestion(q);
              if($('#learningMode').checked){ showExplain(q, true); }
              updateLiveScore();
            });
          });
        } else if(type==='text'){
          const t = q.querySelector('input[type=text]');
          t?.addEventListener('input', ()=>{
            evaluateQuestion(q);
            if($('#learningMode').checked && t.value.trim().length){ showExplain(q, true); }
            updateLiveScore();
          });
        } else if(type==='classify'){
          // drag & drop wiring
          const chips = q.querySelectorAll('.chip');
          chips.forEach(ch=>{
            ch.addEventListener('dragstart', e=>{ e.dataTransfer.setData('text/plain', ch.dataset.value||''); q._dragEl = ch; });
          });
          q.querySelectorAll('.bucket').forEach(b=>{
            b.addEventListener('dragover', e=>{e.preventDefault(); b.classList.add('hover');});
            b.addEventListener('dragleave', ()=>b.classList.remove('hover'));
            b.addEventListener('drop', e=>{e.preventDefault(); b.classList.remove('hover'); if(q._dragEl){ b.appendChild(q._dragEl); evaluateQuestion(q); if($('#learningMode').checked){ showExplain(q,true);} updateLiveScore(); }});
          });
        } else if(type==='segment'){
          q.querySelectorAll('.segment').forEach(btn=>{
            btn.addEventListener('click', ()=>{
              q.querySelectorAll('.segment').forEach(x=>x.classList.remove('selected'));
              btn.classList.add('selected');
              q.dataset.segmentSelected = btn.dataset.idx;
              evaluateQuestion(q);
              if($('#learningMode').checked){ showExplain(q,true); }
              updateLiveScore();
            });
          });
          // draw tiny illustrative chart (no external libs)
          const cv = $('#miniChart');
          if(cv && cv.getContext){
            const ctx = cv.getContext('2d');
            const W = cv.width, H = cv.height;
            ctx.clearRect(0,0,W,H);
            const margin = 24; const h=H-2*margin; const w=W-2*margin;
            const x = i=>margin + (i/8)*w; // 9 points
            const y = v=>margin + (1-v)*h;
            // sample series: policy rate (blue), loan growth (green)
            const rate = [0.2,0.22,0.25,0.28,0.35,0.5,0.55,0.52,0.48];
            const loan = [0.55,0.56,0.58,0.57,0.53,0.48,0.44,0.43,0.45];
            ctx.strokeStyle = 'rgba(80,140,255,0.9)'; ctx.lineWidth = 2;
            ctx.beginPath(); rate.forEach((v,i)=>{ const px=x(i), py=y(v); if(i===0) ctx.moveTo(px,py); else ctx.lineTo(px,py);}); ctx.stroke();
            ctx.strokeStyle = 'rgba(100,220,150,0.9)'; ctx.lineWidth = 2;
            ctx.beginPath(); loan.forEach((v,i)=>{ const px=x(i), py=y(v); if(i===0) ctx.moveTo(px,py); else ctx.lineTo(px,py);}); ctx.stroke();
          }
        }
      });
    }

    function injectAnswerButtons(){
      $$('#questions .q').forEach(q=>{
        if(q.querySelector('.answer-btn')) return;
        let footer = q.querySelector('footer');
        if(!footer){
          footer = document.createElement('footer');
          footer.className = 'row';
          q.appendChild(footer);
        }
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'answer-btn';
        btn.textContent = 'è§£ç­”ã‚’è¡¨ç¤º';
        btn.addEventListener('click', ()=>{
          const exp = q.querySelector('.explain');
          if(!exp) return;
          const willShow = !exp.classList.contains('show');
          showExplain(q, willShow);
          if(willShow){
            exp.scrollIntoView({behavior:'smooth', block:'nearest'});
          }
        });
        footer.appendChild(btn);
      });
    }

    // Helpers: answers & score
    function isAnswered(q){
      const t=q.dataset.type;
      if(t==='mc') return !!q.querySelector('input[type=radio]:checked');
      if(t==='ms') return q.querySelectorAll('input[type=checkbox]:checked').length>0;
      if(t==='text'){
        const v=q.querySelector('input[type=text]')?.value.trim();
        return !!v;
      }
      if(t==='classify'){
        const s=q.querySelector('.bucket[data-group="stock"]');
        const f=q.querySelector('.bucket[data-group="flow"]');
        return (s?.querySelectorAll('.chip').length||0) + (f?.querySelectorAll('.chip').length||0) > 0;
      }
      if(t==='segment'){
        return !!q.dataset.segmentSelected;
      }
      return false;
    }

    // Live score (header badge)
    function computeLiveScore(){
      const qs = $$('#questions .q'); let total=0,answered=0,correct=0;
      const eq=(a,b)=>JSON.stringify((a||[]).slice().sort())===JSON.stringify((b||[]).slice().sort());
      qs.forEach(q=>{
        total++;
        const type=q.dataset.type; const ans=(q.dataset.answer||'').trim(); let ok=null;
        if(type==='mc'){
          const p=q.querySelector('input[type=radio]:checked')?.value; if(p){answered++; ok=(p===ans);} }
        else if(type==='ms'){
          const picked=Array.from(q.querySelectorAll('input[type=checkbox]:checked')).map(i=>i.value); if(picked.length){answered++; ok=eq(picked, ans.split(',').map(s=>s.trim()));} }
        else if(type==='text'){
          const v=q.querySelector('input[type=text]')?.value.trim(); if(v){answered++; const mode=(q.dataset.eval||'exact').toLowerCase(); ok=(mode==='regex')?(()=>{try{return new RegExp(ans,'i').test(v);}catch(e){return false;}})():(v===ans);} }
        else if(type==='classify'){
          const parse=s=>Object.fromEntries(s.split(';').map(p=>{const [g,l]=p.split(':'); return [g.trim(), (l?l.split(',').map(x=>x.trim()).filter(Boolean):[])];})); const gold=parse(ans); const groups=Object.keys(gold); let any=false; const all=groups.every(g=>{ const vals=Array.from(q.querySelector('.bucket[data-group="'+g+'"]')?.querySelectorAll('.chip')||[]).map(c=>c.dataset.value); if(vals.length) any=true; return eq(vals,gold[g]);}); if(any){answered++; ok=all;}
        }
        else if(type==='segment'){
          const p=q.dataset.segmentSelected; if(p){answered++; ok=(p===ans);} }
        if(ok===true) correct++;
      });
      return {total,answered,correct};
    }
    function updateLiveScore(){ const s=computeLiveScore(); const el=$('#score-badge'); if(el){ el.textContent = s.correct+' / '+s.total; el.title='å›ç­”æ¸ˆã¿ '+s.answered+' / '+s.total; } }

    function showAnswersAndScore(){
      let total=0, correct=0, answered=0;
      $$('#questions .q').forEach(q=>{
        total++;
        const r=evaluateQuestion(q);
        if(isAnswered(q)) answered++;
        if(r.ok===true) correct++;
        // highlight correct choices
        const gold=(q.dataset.answer||'').split(',').map(s=>s.trim());
        if(q.dataset.type==='mc' || q.dataset.type==='ms'){
          q.querySelectorAll('.choice').forEach(lbl=>{
            const v=lbl.querySelector('input')?.value; if(!v) return;
            if(gold.includes(v)) lbl.classList.add('correct');
          });
        } else if(q.dataset.type==='text'){
          const exp=q.querySelector('.explain');
          if(exp && !exp.dataset.hinted){
            const hint=document.createElement('div');
            hint.className='muted';
            hint.innerHTML='<strong>è§£ç­”ãƒ’ãƒ³ãƒˆ:</strong> æ­£è¦è¡¨ç¾: <code>'+escapeHtml(q.dataset.answer||'')+'</code>';
            exp.appendChild(hint);
            exp.dataset.hinted='1';
          }
        }
        showExplain(q,true);
      });
      const box=$('#results');
      box.innerHTML = '<h4 style="margin:0 0 8px">ã‚¹ã‚³ã‚¢</h4>'+
        '<p>æ­£ç­”: <strong>'+correct+'</strong> / '+total+'ï¼ˆå›ç­”æ¸ˆã¿: '+answered+'ï¼‰</p>';
      box.style.display='block';
    }

    // Init
    applyInitialTheme();
    prefersDark.addEventListener?.('change', event=>{
      let stored = null;
      try{ stored = localStorage.getItem(THEME_KEY); }catch(e){ stored = null; }
      if(stored) return;
      setTheme(event.matches ? 'dark' : 'light', false);
    });
    applySettings();
  injectAnswerButtons();
  attachHandlers();
  updateLiveScore();
  })();
  </script>
</body>
</html>
